import * as XLSX from "xlsx";

// マッピング定義
export const categoryMapping: { [key: string]: { [key: string]: string } } = {
  建築: {
    "社員番号": "社員番号",
    "氏名": "姓　名（全角スペースを空けてください）",
    "司会進行 朝（施工管理）": "朝礼・昼礼",
    "KYK指導（施工）": "朝礼・昼礼",
    "司会進行 昼（施工管理）": "朝礼・昼礼",
    "業者間（施工管理）": "朝礼・昼礼",
    "新規入場者教育": "安全管理",
    "安全書類作成": "安全管理",
    "撮影": "写真管理",
    "管理・まとめ": "写真管理",
    "総合仮設計画(仮囲・電気・水道)": "仮設工事",
    "足場計画": "仮設工事",
    "足場数量拾い": "仮設工事",
    "型枠支保工計算": "仮設工事",
    "仮設EV": "仮設工事",
    "揚重機": "仮設工事",
    "仮設構台": "仮設工事",
    "場所打杭": "杭工事",
    "PC杭": "杭工事",
    "親杭横矢板": "山留工事",
    "シートパイル": "山留工事",
    "切梁工事": "山留工事",
    "SMW": "山留工事",
    "配筋チェック": "鉄筋・コンクリート工事",
    "配筋写真": "鉄筋・コンクリート工事",
    "数量拾い": "仮設工事",
    "生コン発注": "鉄筋・コンクリート工事",
    "受入検査立会": "鉄筋・コンクリート工事",
    "打設数量調整": "鉄筋・コンクリート工事",
    "工場・受入検査": "鉄筋・コンクリート工事",
    "建て入れ精度管理": "鉄筋・コンクリート工事",
    "溶接・ボルト接合管理": "鉄筋・コンクリート工事",
    "耐火被覆": "鉄筋・コンクリート工事",
    "ALC工事": "外部（ALC・PC）・外壁改修工事",
    "PC工事": "外部（ALC・PC）・外壁改修工事",
    "外構工事": "外部（ALC・PC）・外壁改修工事",
    "植栽工事": "外部（ALC・PC）・外壁改修工事",
    "立駐工事": "外部（ALC・PC）・外壁改修工事",
    "外装（外壁・屋根）工事": "外部（ALC・PC）・外壁改修工事",
    "アスファルト防水（施工管理）": "防水工事",
    "シート防水（施工管理）": "防水工事",
    "塗布防水（施工管理）": "防水工事",
    "シーリング": "防水工事",
    "タイル下地": "左官（タイル・石・塗装）工事",
    "吹付け下地": "左官（タイル・石・塗装）工事",
    "レべリング": "左官（タイル・石・塗装）工事",
    "施工管理経験": "左官（タイル・石・塗装）工事",
    "タイル工事": "左官（タイル・石・塗装）工事",
    "石工事": "左官（タイル・石・塗装）工事",
    "塗装工事": "左官（タイル・石・塗装）工事",
    "木製建具": "建具工事",
    "鋼製建具（施工管理）": "建具工事",
    "アルミ製建具": "建具工事",
    "ステンレス建具": "建具工事",
    "自動ドア": "建具工事",
    "発泡ウレタン": "断熱・内装工事",
    "仕上げ墨出し": "断熱・内装工事",
    "ボード": "断熱・内装工事",
    "壁・間仕切り下地": "断熱・内装工事",
    "家具・造作工事": "断熱・内装工事",
    "フローリング": "断熱・内装工事",
    "カーペット": "断熱・内装工事",
    "畳": "断熱・内装工事",
    "タイルカーペット・CF": "断熱・内装工事",
    "進捗チェック": "断熱・内装工事",
    "エレベーター工事": "断熱・内装工事",
    "クリーニング": "断熱・内装工事",
    "内覧立会い": "断熱・内装工事",
    "木造建物解体": "解体工事",
    "コンクリート造建物解体": "解体工事",
    "鉄骨造建物解体": "解体工事",
    "内装ダメチェック": "内装ダメチェック・内覧立会",
    "積算": "積算",
    "工事原価": "関係書類作成・各種打合実施",
    "88条関係書類": "関係書類作成・各種打合実施",
    "施工計画報告書": "関係書類作成・各種打合実施",
    "施工結果報告書": "関係書類作成・各種打合実施",
    "住宅性能評価": "関係書類作成・各種打合実施",
    "竣工書類": "関係書類作成・各種打合実施",
    "道路使用許可": "関係書類作成・各種打合実施",
    "道路占用許可": "関係書類作成・各種打合実施",
    "沿道掘削": "関係書類作成・各種打合実施",
    "歩道切り下げ": "関係書類作成・各種打合実施",
    "週間工程表": "関係書類作成・各種打合実施",
    "月間工程表": "関係書類作成・各種打合実施",
    "全体工程表": "関係書類作成・各種打合実施",
    "関連法規の理解": "関係書類作成・各種打合実施",
    "安全協議会資料作成": "関係書類作成・各種打合実施",
    "役所提出書類作成": "関係書類作成・各種打合実施",
    "施主との打合せ": "関係書類作成・各種打合実施",
    "設計事務所との打合せ": "関係書類作成・各種打合実施",
    "VE活動": "関係書類作成・各種打合実施",
    "ISO関係書類作成": "関係書類作成・各種打合実施",
  },
  土木: {
    "社員番号":"社員番号",
    "氏名":"姓　名（全角スペースを空けてください）",
    "基本業務 朝礼":"朝礼・昼礼",
    "司会進行朝":"朝礼・昼礼",
    "KYKの指導":"朝礼・昼礼",
    "基本業務 昼礼":"朝礼・昼礼",
    "司会進行昼":"朝礼・昼礼",
    "業者間":"朝礼・昼礼",
    "基本業務 安全管理":"安全管理",
    "新規入場者教育":"安全管理",
    "安全書類作成":"安全管理",
    "撮影":"写真管理",
    "管理・まとめ":"写真管理",
    "電気設備工事":"電気設備工事",
    "計装設備工事":"計装設備工事",
    "防災設備工事（設備）":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "給排水衛生設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "空調・換気設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "プラント設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "ガス設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "冷暖房設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "換気設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "空気清浄装置設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "プラント配管設備工事":"防災設備・給排水衛生設備・空調_換気設備・プラント設備工事",
    "給水設備工事":"給水設備・給湯設備工事",
    "給湯設備工事":"給水設備・給湯設備工事",
    "ソーラーシステム設備工事":"給水設備・給湯設備工事",
    "排水設備工事":"排水設備工事",
    "衛生器具設備工事":"衛生器具設備工事",
    "下水（浄化槽等）設備工事":"衛生器具設備工事",
    "消火設備工事":"消火設備工事",
    "冷凍・冷蔵設備工事":"冷暖房設備工事",
    "クリーンルーム工事":"換気設備工事",
    "ダクト設備工事":"ダクト設備工事",
    "週間工程表":"週間工程表・月間工程表・全体工程表",
    "月間工程表":"週間工程表・月間工程表・全体工程表",
    "全体工程表":"週間工程表・月間工程表・全体工程表",
    "電力会社への手続き":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "消防への手続き":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "メーターの測定":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "スリーブ・箱抜き計画・補強":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "機器の手配・搬入計画":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "防火区画に関する知識":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "排煙設備に関する知識":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "消防法に関する知識":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "危険物に関する知識":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "給水配管サイズの計算":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "空調・換気ダクトサイズの計算":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "機器類についての知識":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "関連法規の理解":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "安全協議会資料作成":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "役所提出書類作成":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "施工計画書作成":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "工事報告書":"関連法規の理解・安全協議会資料作成・役所提出書類作成・施工計画書作成・工事報告書",
    "ゼネコンとの打合せ":"ゼネコンとの打ち合わせ",
  },
};


// データ加工関数
export const processExportData = (data: any[], mapping: Record<string, string>): any[] => {
  console.log("call processExportData");
  return data.map((row) => {
    const processedRow: Record<string, any> = {};

    // マッピングに従ってデータを構成
    Object.keys(mapping).forEach((exportKey) => {
      const sourceKey = mapping[exportKey];
      processedRow[exportKey] = row[sourceKey] || ""; // 対応するデータがない場合は空文字
    });

    return processedRow;
  });
};

// エクセルファイル生成関数
export const exportToExcel = (data: any[], fileName: string) => {
  const worksheet = XLSX.utils.json_to_sheet(data);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, "Export");
  XLSX.writeFile(workbook, fileName);
};
